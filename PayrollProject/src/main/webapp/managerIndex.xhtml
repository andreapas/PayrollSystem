<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<link rel="stylesheet" type="text/css" href="css/style.css"></link>
	<script type="text/javascript" src="js/scripts.js"></script>
</h:head>

<h:body>

	<script type="text/javascript">
	$( document ).ready(function() {
		showElementsOfRole("#{employeeBean.loggedUser.role}");
	});
	</script>

	<!-- 	<h:form> -->
	<div class="ui-g">

		<div class="ui-g-3">

			<p:panel id="mainMenu" header="Menu">
				<h:panelGrid columns="1" cellpadding="10">

					<p>Welcome #{employeeBean.loggedUser.name}</p>
					<h:form>
						<h:commandButton value="logout"
							action="#{sessionManagementBean.logout()}" />
					</h:form>
					<p:button value="Overview" icon="fa fa-eye"
						onclick="return showOnlyDivByClass('overviewPanel','dynamicPanel')" />
					<p:button value="Settings" icon="fa fa-gears"
						onclick="return showOnlyDivByClass('settingsPanel','dynamicPanel')" />
					<p:button value="Employees Management" icon="fa fa-users"
						onclick="return showOnlyDivByClass('employeesManagementPanel','dynamicPanel')" />

				</h:panelGrid>
			</p:panel>

		</div>

		<div class="ui-g-9">
			<p:growl id="infoGrowl" autoUpdate="true" severity="info"
				sticky="false" life="3000" showDetail="true"></p:growl>
			<p:messages id="warnErrorPanel" autoUpdate="true" showDetail="true"
				severity="warn,error,fatal" closable="true" />

			<p:panel header="Overview" class="dynamicPanel overviewPanel">
				<h:panelGrid cellpadding="10">
					<p:dataTable var="employee" value="#{employeeBean.loggedUser}"
						rows="1">
						<p:column headerText="Code">
							<h:outputText value="#{employee.code}" />
						</p:column>
						<p:column headerText="Name">
							<h:outputText value="#{employee.name}" />
						</p:column>
						<p:column headerText="Surname">
							<h:outputText value="#{employee.surname}" />
						</p:column>
						<p:column headerText="Email">
							<h:outputText value="#{employee.email}" />
						</p:column>
						<p:column headerText="Union Name">
							<h:outputText value="#{employee.union.unionName}" />
						</p:column>
					</p:dataTable>
				</h:panelGrid>
			</p:panel>
			<p:panel header="Settings" class="dynamicPanel settingsPanel">
				<h:form>
					<p:panel header="Personal Informations"
						class="dynamicPanel settingsPanel">
						<h:panelGrid cellpadding="10" id="updateInfos">
							<p:outputLabel for="paymentMethod" value="Method of payment:" />
							<p:selectOneRadio id="paymentMethod"
								value="#{employeeBean.radioVal}">
								<f:selectItem itemLabel="Mailed to the postal address"
									itemValue="Postal address" />
								<f:selectItem itemLabel="Held for pickup by the paymaster"
									itemValue="Paymaster" />
								<f:selectItem itemLabel="Deposited into the bank account"
									itemValue="Bank account" />
								<p:ajax process="paymentMethod" update="updateInfos" />
							</p:selectOneRadio>
							<p:panel header="Additional Informations"
								rendered="#{employeeBean.radioVal eq 'Postal address'}">
								<h:panelGrid columns="2">
									<p:outputLabel for="street" value="Street:" />
									<p:inputText id="street" value="#{employeeBean.address.street}" required="true" />

									<p:outputLabel for="num" value="Number:" />
									<p:inputText id="num" value="#{employeeBean.address.number}" required="true"
										label="num">
										<f:validateDoubleRange minimum="1" maximum="999999" />
									</p:inputText>

									<p:outputLabel for="cap" value="CAP:" />
									<p:inputMask id="cap" value="#{employeeBean.address.cap}" required="true"
										mask="99999" />

									<p:outputLabel for="munic" value="Municipality:" />
									<p:inputText id="munic" required="true"
										value="#{employeeBean.address.municipality}" />

									<p:outputLabel for="disCode" value="District Code:" />
									<p:selectOneMenu id="disCode"
										value="#{employeeBean.address.districtCode}"
										style="width:125px">
										<f:selectItems
											value="#{employeeBean.address.districtCodeList}"
											var="disList" itemLabel="#{disList}" />
									</p:selectOneMenu>

								</h:panelGrid>

							</p:panel>
							<p:panel header="Additional Informations"
								rendered="#{employeeBean.radioVal eq 'Bank account'}">
								<h:panelGrid columns="2">
									<p:outputLabel for="bank" value="IBAN:" />
									<p:inputMask id="bank" value="#{employeeBean.loggedUser.payment_method}" size="27"
										required="true" mask="aa99**********************" />
								</h:panelGrid>
							</p:panel>


							<p:outputLabel for="email" value="New email address:" />
							<p:inputText id="email" placeholder="Email"
								value="#{employeeBean.loggedUser.email}" />

							<p:outputLabel for="union" value="Change Union:" />
							<p:selectOneMenu id="union"
								value="#{employeeBean.loggedUser.union}" style="width:125px"
								converter="unionTranslator">
								<f:selectItems value="#{unionsBean.unionsList}" var="union"
									itemLabel="#{union.unionName}" />
							</p:selectOneMenu>

							<p:commandButton value="Submit updated informations"
								actionListener="#{employeeBean.updateInfo()}" />
						</h:panelGrid>
					</p:panel>
				</h:form>
				<h:form>
					<p:panel header="Password Management"
						class="dynamicPanel settingsPanel">
						<h:panelGrid cellpadding="10">
							<h:outputText value="Old Password: " />
							<p:password id="oldPassword"
								value="#{sessionManagementBean.oldLoginCredentials.password}"
								required="true" label="password" />

							<h:outputText value="New Password: " />
							<p:password id="newPassword"
								value="#{sessionManagementBean.newLoginCredentials.password}"
								feedback="true" match="repeatNewPassword" required="true" />

							<h:outputText value="Repeat New Password: " />
							<p:password id="repeatNewPassword"
								value="#{sessionManagementBean.newLoginCredentials.password}"
								feedback="true" required="true" />

							<p:commandButton value="Change Password"
								actionListener="#{sessionManagementBean.modifyPassword()}" />
						</h:panelGrid>
					</p:panel>
				</h:form>

			</p:panel>

			<p:panel header="User Management"
				class="dynamicPanel employeesManagementPanel">
				<h:panelGrid cellpadding="5" columns="3">

					<p:button value="Add employee"
						onclick="return showOnlyDivByClass('selectTypePanel','usersSubPanel')"
						icon="fa fa-user-plus" />
					<p:button value="Edit employee"
						onclick="return showOnlyDivByClass('editEmployeePanel','usersSubPanel');"
						icon="fa fa-edit" />
					<p:button value="Delete employee"
						onclick="return showOnlyDivByClass('deleteEmployeePanel','usersSubPanel');"
						icon="fa fa-remove" />

				</h:panelGrid>
			</p:panel>

			<p:panel header="Select type of Employee"
				class="dynamicPanel usersSubPanel selectTypePanel">
				<h:panelGrid cellpadding="5" columns="2">
					<p:button value="Part-time Employee"
						onclick="return showOnlyDivByClass('insertDetailsPanelPartTime','typeSubPanel')" />
					<p:button value="Full-time Employee"
						onclick="return showOnlyDivByClass('insertDetailsPanelFullTime','typeSubPanel')" />
				</h:panelGrid>
			</p:panel>
			<h:form>
				<p:panel header="Insert Employee Details - Part Time Employee"
					class="dynamicPanel usersSubPanel typeSubPanel insertDetailsPanelPartTime">
					<h:panelGrid id="partGrid" cellpadding="5" columns="2">
						<p:outputLabel for="parthirecode" value="Code:"></p:outputLabel>
						<p:inputText id="parthirecode" placeholder="Code" required="true"
							value="#{employeeBean.partTimeEmployee.code}"></p:inputText>

						<p:outputLabel for="parthirename" value="Name:"></p:outputLabel>
						<p:inputText id="parthirename" placeholder="Name" required="true"
							value="#{employeeBean.partTimeEmployee.name}"></p:inputText>

						<p:outputLabel for="parthiresurname" value="Surname:"></p:outputLabel>
						<p:inputText id="parthiresurname" placeholder="Surname"
							required="true" value="#{employeeBean.partTimeEmployee.surname}"></p:inputText>

						<p:outputLabel for="parthireemail" value="Email:"></p:outputLabel>
						<p:inputText id="parthireemail" placeholder="Email"
							required="true" value="#{employeeBean.partTimeEmployee.email}"></p:inputText>

						<p:outputLabel for="parthirepaymentMethod" value="Payment Method:"></p:outputLabel>
						<p:selectOneMenu id="parthirepaymentMethod"
							value="#{employeeBean.partTimeEmployee.payment_method}"
							style="width:125px">
							<f:selectItem itemLabel="Paymaster" itemValue="Paymaster" />
							<f:selectItem itemLabel="Postal Address"
								itemValue="Postal address" />
							<f:selectItem itemLabel="Bank Account" itemValue="Bank account" />
						</p:selectOneMenu>

						<p:outputLabel for="parthirerate" value="Hourly Rate:"></p:outputLabel>
						<p:inputNumber id="parthirerate" required="true"
							value="#{employeeBean.partTimeEmployee.hourlyRate}" symbol=" €/h"
							symbolPosition="s" decimalSeparator="," thousandSeparator="."></p:inputNumber>

						<p:outputLabel for="parthireunion" value="Union name:"></p:outputLabel>
						<p:selectOneMenu id="parthireunion"
							value="#{employeeBean.partTimeEmployee.union}"
							style="width:125px" converter="unionTranslator">
							<!-- 				            <f:selectItem itemLabel="Select One" itemValue="" /> -->
							<f:selectItems value="#{unionsBean.unionsList}" var="union"
								itemLabel="#{union.unionName}" />
						</p:selectOneMenu>

						<p:commandButton value="Add"
							actionListener="#{employeeBean.hirePartTimeEmployee()}"
							ajax="false" />
					</h:panelGrid>
				</p:panel>
			</h:form>
			<h:form>
				<p:panel header="Insert Employee Details - Full Time Employee"
					class="dynamicPanel usersSubPanel typeSubPanel insertDetailsPanelFullTime">
					<h:panelGrid id="fullGrid" cellpadding="5" columns="2">
						<p:outputLabel for="fullhirecode" value="Code:"></p:outputLabel>
						<p:inputText id="fullhirecode" placeholder="Code" required="true"
							value="#{employeeBean.fullTimeEmployee.code}"></p:inputText>

						<p:outputLabel for="fullhirename" value="Name:"></p:outputLabel>
						<p:inputText id="fullhirename" placeholder="Name" required="true"
							value="#{employeeBean.fullTimeEmployee.name}"></p:inputText>

						<p:outputLabel for="fullhiresurname" value="Surname:"></p:outputLabel>
						<p:inputText id="fullhiresurname" placeholder="Surname"
							required="true" value="#{employeeBean.fullTimeEmployee.surname}"></p:inputText>

						<p:outputLabel for="fullhireemail" value="Email:"></p:outputLabel>
						<p:inputText id="fullhireemail" placeholder="Email"
							required="true" value="#{employeeBean.fullTimeEmployee.email}"></p:inputText>

						<p:outputLabel for="fullhirepaymentMethod" value="Payment Method:"></p:outputLabel>
						<p:selectOneMenu id="fullhirepaymentMethod"
							value="#{employeeBean.fullTimeEmployee.payment_method}"
							style="width:125px">
							<f:selectItem itemLabel="Paymaster" itemValue="Paymaster" />
							<f:selectItem itemLabel="Postal Address"
								itemValue="Postal address" />
							<f:selectItem itemLabel="Bank Account" itemValue="Bank account" />
						</p:selectOneMenu>

						<p:outputLabel for="fullhiresalary" value="Salary:"></p:outputLabel>
						<p:inputNumber id="fullhiresalary" required="true"
							value="#{employeeBean.fullTimeEmployee.salary}" symbol=" €"
							symbolPosition="s" decimalSeparator="," thousandSeparator="."></p:inputNumber>

						<p:outputLabel for="fullhireunion" value="Union name:"></p:outputLabel>
						<p:selectOneMenu id="fullhireunion"
							value="#{employeeBean.fullTimeEmployee.union}"
							style="width:125px" converter="unionTranslator">
							<!-- 				            <f:selectItem itemLabel="Select One" itemValue="" /> -->
							<f:selectItems value="#{unionsBean.unionsList}" var="union"
								itemLabel="#{union.unionName}" />
						</p:selectOneMenu>


						<p:commandButton value="Add"
							actionListener="#{employeeBean.hireFullTimeEmployee()}"
							oncomplete="closeMessages()" ajax="false" />
					</h:panelGrid>
				</p:panel>
			</h:form>
			<h:form id="form">
				<p:panel header="Edit Employee"
					class="dynamicPanel usersSubPanel editEmployeePanel">
					<h:panelGrid columns="3">
						<p:dataTable value="#{employeeBean.employeeList}" var="employee"
							rowKey="#{employee.code}" widgetVar="editTable" rows="10"
							rowsPerPageTemplate="5,10,15" editable="true">
							<p:ajax event="rowEdit" listener="#{employeeBean.onRowEdit}" />
							<p:ajax event="rowEditCancel"
								listener="#{employeeBean.onRowCancel}" />
							<f:facet name="header">
								<p:outputPanel>
									<h:outputText value="Search all fields:" />
									<p:inputText id="globalFilter"
										onkeyup="PF('editTable').filter()" style="width:150px"
										placeholder="Enter keyword" />
								</p:outputPanel>
							</f:facet>

							<p:column sortBy="#{employee.code}" filterBy="#{employee.code}"
								filterStyle="display:none" headerText="Code">
								<h:outputText value="#{employee.code}" />
							</p:column>

							<p:column sortBy="#{employee.name}" filterBy="#{employee.name}"
								filterStyle="display:none" headerText="Name">
								<p:cellEditor>
									<f:facet name="output">
										<h:outputText value="#{employee.name}" />
									</f:facet>
									<f:facet name="input">
										<p:inputText id="employeeName" value="#{employee.name}" />
									</f:facet>
								</p:cellEditor>
							</p:column>

							<p:column sortBy="#{employee.surname}"
								filterBy="#{employee.surname}" filterStyle="display:none"
								headerText="Surname">
								<p:cellEditor>
									<f:facet name="output">
										<h:outputText value="#{employee.surname}" />
									</f:facet>
									<f:facet name="input">
										<p:inputText id="employeeSurname" value="#{employee.surname}" />
									</f:facet>
								</p:cellEditor>
							</p:column>

							<p:column filterBy="#{employee.email}" filterStyle="display:none"
								headerText="Email">
								<p:cellEditor>
									<f:facet name="output">
										<h:outputText value="#{employee.email}" />
									</f:facet>
									<f:facet name="input">
										<p:inputText id="employeeEmail" value="#{employee.email}" />
									</f:facet>
								</p:cellEditor>
							</p:column>

							<p:column filterBy="#{employee.union.unionName}"
								filterStyle="display:none" headerText="Union">
								<p:cellEditor>
									<f:facet name="output">
										<h:outputText value="#{employee.union.unionName}" />
									</f:facet>
									<f:facet name="input">
										<h:selectOneMenu value="#{employee.union}" style="width:100%"
											converter="unionTranslator">
											<f:selectItems value="#{unionsBean.unionsList}" var="union"
												itemLabel="#{union.unionName}" itemValue="#{union}" />
										</h:selectOneMenu>
									</f:facet>
								</p:cellEditor>
							</p:column>
							<p:column style="width:32px">
								<p:rowEditor />
							</p:column>
						</p:dataTable>
					</h:panelGrid>
				</p:panel>
			</h:form>
			<p:panel header="Delete Employee"
				class="dynamicPanel usersSubPanel deleteEmployeePanel">
				<h:panelGrid columns="3">
					<p:dataTable var="employee" widgetVar="employeesTable"
						value="#{employeeBean.employeeList}" rows="10"
						rowsPerPageTemplate="5,10,15">
						<f:facet name="header">
							<p:outputPanel>
								<h:outputText value="Search all fields:" />
								<p:inputText id="globalFilter"
									onkeyup="PF('employeesTable').filter()" style="width:150px"
									placeholder="Enter keyword" />
							</p:outputPanel>
						</f:facet>
						<p:column sortBy="#{employee.code}" filterBy="#{employee.code}"
							filterStyle="display:none" headerText="Code">
							<h:outputText value="#{employee.code}" />
						</p:column>

						<p:column sortBy="#{employee.name}" filterBy="#{employee.name}"
							filterStyle="display:none" headerText="Name">
							<h:outputText value="#{employee.name}" />
						</p:column>

						<p:column sortBy="#{employee.surname}"
							filterBy="#{employee.surname}" filterStyle="display:none"
							headerText="Surname">
							<h:outputText value="#{employee.surname}" />
						</p:column>

						<p:column filterBy="#{employee.email}" filterStyle="display:none"
							headerText="Email">
							<h:outputText value="#{employee.email}" />
						</p:column>

						<p:column filterBy="#{employee.union.unionName}"
							filterStyle="display:none" headerText="Union">
							<h:outputText value="#{employee.union.unionName}" />
						</p:column>

					</p:dataTable>
				</h:panelGrid>
				<h:form>
					<h:panelGrid cellpadding="10">
						<p:panel>
							<p:outputLabel value="Code of the Employee to fire" />
							<p:inputText value="#{employeeBean.fireCode}" />
							<p:commandButton value="Fire"
								action="#{employeeBean.fireEmployee()}" ajax="false" />
						</p:panel>
					</h:panelGrid>
				</h:form>

			</p:panel>
		</div>

	</div>
	<!-- 	</h:form> -->

</h:body>
</html>